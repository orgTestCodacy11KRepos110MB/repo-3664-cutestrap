import { on } from '../vendor/ion/app.js?CACHEBUST';

const iconClass = 'icon';

const symbols = `
    <svg style="display: none">
      <defs>
        <g id="blank">
          <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"></svg>
        </g>

        <g id="caret-down">
          <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 6L8 10L4 6H12Z" fill="currentColor" />
          </svg>
        </g>

        <g id="caret-right">
          <svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M8.33334 5L13.3333 10L8.33334 15L8.33334 5Z" fill="currentColor" />
          </svg>
        </g>

        <g id="checkmark">
          <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
            <path d="M5.48764 12.4309L2.00098 8.94359L2.94431 8.00092L5.48764 10.5449L13.0563 2.97559L13.9996 3.91825L5.48764 12.4309Z" fill="currentColor"/>
          </svg>
        </g>

        <g id="close">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20.3642 18.95L13.4142 12L20.3642 5.04999L18.9502 3.63599L12.0002 10.586L5.05023 3.63599L3.63623 5.04999L10.5862 12L3.63623 18.95L5.05023 20.364L12.0002 13.414L18.9502 20.364L20.3642 18.95Z" fill="currentColor" />
          </svg>
        </g>

        <g id="download">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13 15V2H11V15L7.80001 12.6L6.60001 14.2L12 18.25L17.4 14.2L16.2 12.6L13 15ZM2 20H4H20H22V22H2V20Z" fill="currentColor" />
          </svg>
        </g>

        <g id="globe">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.06109 13.1662L1.11545 13.7012L1.13188 13.7085C1.86133 18.3863 5.53849 22.0879 10.204 22.8541L10.2103 22.8761L10.8436 22.9399C11.0851 22.9652 11.3289 22.9826 11.5748 22.9919C11.7159 22.9973 11.8576 23 12 23C15.6111 23 18.8159 21.2599 20.8214 18.5725L21 18.3348V18.3262C22.2601 16.5368 23 14.3548 23 12C23 8.13845 21.0102 4.74163 18 2.77893V2.76103L17.5523 2.50206C15.9226 1.5473 14.0252 1 12 1C5.92487 1 1 5.92487 1 12C1 12.3939 1.02071 12.783 1.06109 13.1662ZM3 12C3 7.02944 7.02944 3 12 3C12.0866 3 12.1729 3.00122 12.2589 3.00365C13.6 3.04153 14.8677 3.37279 16 3.93552V5C16 5.55228 15.5523 6 15 6H13V7C13 7.55228 12.5523 8 12 8H8.49955L11.0015 14H14C14.5523 14 15 14.4477 15 15V16H18C18.5523 16 19 16.4477 19 17V17.6573C17.3534 19.6922 14.8374 20.9948 12.017 21C12.0113 21 12.0057 21 12 21C11.9175 21 11.8353 20.9989 11.7534 20.9967L10.6249 17.0472L9.9268 16.9974C9.40919 16.9605 9 16.5276 9 16V15.0168L3.0068 12.3532C3.00525 12.3129 3.00396 12.2726 3.00294 12.2323C3.00098 12.1551 3 12.0777 3 12ZM17.9871 5.28015C17.8458 6.80565 16.5624 8 15 8H14.8293C14.4175 9.16519 13.3062 10 12 10H11.5005L12.3344 12H14C15.3062 12 16.4175 12.8348 16.8293 14H18C18.9872 14 19.863 14.4768 20.4097 15.2127C20.7911 14.2149 21 13.1318 21 12C21 9.32828 19.8358 6.92846 17.9871 5.28015ZM9.58027 20.671C6.65751 19.8571 4.33398 17.6051 3.42006 14.7255L7.01731 16.3242C7.14462 17.5094 7.9619 18.4875 9.05986 18.8496L9.58027 20.671Z" fill="currentColor" />
          </svg>
        </g>

        <g id="link">
          <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 3.33337H8.44669C6.86246 3.33305 5.49687 4.44782 5.18002 6.00004H4.00002C2.15907 6.00004 0.666687 7.49243 0.666687 9.33337C0.666687 11.1743 2.15907 12.6667 4.00002 12.6667H7.55335C9.13758 12.667 10.5032 11.5523 10.82 10H12C13.841 10 15.3334 8.50766 15.3334 6.66671C15.3334 4.82576 13.841 3.33337 12 3.33337ZM7.55335 11.3334H4.00002C2.89545 11.3334 2.00002 10.4379 2.00002 9.33337C2.00002 8.2288 2.89545 7.33337 4.00002 7.33337H5.18002C5.49687 8.8856 6.86246 10.0004 8.44669 10H9.43335C9.15152 10.7972 8.39886 11.331 7.55335 11.3334ZM6.56669 7.33337H7.55335C8.39886 7.33575 9.15152 7.86956 9.43335 8.66671H8.44669C7.60118 8.66433 6.84852 8.13053 6.56669 7.33337ZM12 8.66671H10.82C10.5032 7.11449 9.13758 5.99972 7.55335 6.00004H6.56669C6.84852 5.20289 7.60118 4.66908 8.44669 4.66671H12C13.1046 4.66671 14 5.56214 14 6.66671C14 7.77128 13.1046 8.66671 12 8.66671Z" fill="currentColor" />
          </svg>
        </g>

        <g id="search">
          <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7.33371 12.0004C9.91104 12.0004 12.0004 9.91104 12.0004 7.33371C12.0004 4.75638 9.91104 2.66704 7.33371 2.66704C4.75638 2.66704 2.66704 4.75638 2.66704 7.33371C2.66704 8.57138 3.15871 9.75837 4.03388 10.6335C4.90905 11.5087 6.09603 12.0004 7.33371 12.0004ZM12.0217 11.079L14.4717 13.529L13.529 14.4717L11.079 12.0217C8.59141 14.0091 4.9846 13.7072 2.86189 11.334C0.739192 8.96082 0.839912 5.3428 3.09136 3.09136C5.3428 0.839912 8.96082 0.739192 11.334 2.86189C13.7072 4.9846 14.0091 8.59141 12.0217 11.079Z" fill="currentColor"/>
          </svg>
        </g>

        <g id="sort-down">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 5V17L21.4 15.2L22.6 16.8L18 20.25L13.4 16.8L14.6 15.2L17 17V5H19ZM7 17V19H1V17H7ZM12 11V13H1V11H12ZM15 5V7H1V5H15Z" fill="currentColor" />
          </svg>
        </g>

        <g id="sort-up">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="m 19,20.25 v -12 l 2.4,1.8 1.2,-1.6 L 18,5 l -4.6,3.45 1.2,1.6 2.4,-1.8 v 12 z M 7,8.25 v -2 H 1 v 2 z m 5,6 v -2 H 1 v 2 z m 3,6 v -2 H 1 v 2 z" fill="currentColor" />
          </svg>
        </g>

        <g id="stacks">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M11.6286 3.07152C11.867 2.97616 12.1329 2.97616 12.3713 3.07152L22.3713 7.07152C22.751 7.22339 22.9999 7.5911 22.9999 8C22.9999 8.4089 22.751 8.77661 22.3713 8.92848L12.3713 12.9285C12.1329 13.0238 11.867 13.0238 11.6286 12.9285L1.62856 8.92848C1.2489 8.77661 0.999946 8.4089 0.999946 8C0.999946 7.5911 1.2489 7.22339 1.62856 7.07152L11.6286 3.07152ZM4.69253 8L11.9999 10.923L19.3074 8L11.9999 5.07703L4.69253 8Z" fill="currentColor" />
            <path d="M11.6582 16.9398L0.658203 12.9398L1.34169 11.0602L11.9999 14.9359L22.6582 11.0602L23.3417 12.9398L12.3417 16.9398C12.1209 17.0201 11.879 17.0201 11.6582 16.9398Z" fill="currentColor" />
            <path d="M0.658203 16.9398L11.6582 20.9398C11.879 21.0201 12.1209 21.0201 12.3417 20.9398L23.3417 16.9398L22.6582 15.0602L11.9999 18.9359L1.34169 15.0602L0.658203 16.9398Z" fill="currentColor" />
          </svg>
        </g>

        <g id="trash">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7 9V20H17V9H19V22H5V9H7ZM11 9V18H9V9H11ZM15 9V18H13V9H15ZM15 2V5H20V7H4V5H9V2H15ZM13 4H11V5H13V4Z" fill="currentColor" />
          </svg>
        </g>
      </defs>
    </svg>
  `;

/* initialize */
const icons = new DOMParser()
  .parseFromString(symbols, "text/xml")
  .querySelectorAll('g[id]');
const ids = [...icons].map(node => node.id);
const selectors = ids.map(id => `icon-${id}`);

initializeIconTags();
initializeIcons();

function initializeIconTags() {
  ids.map(bind);

  function bind(id) {
    const selector = `icon-${id}`;
    on('render', selector, function renderWrapper(event) {
      render(event, id)
    });
  }

  function render(event, id) {
    event.target.innerHTML = `
      <svg viewBox="0 0 16 16" class="${iconClass}">
        <use xlink:href="#${id}"></use>
      </svg>
    `;
  }
}

function initializeIcons() {
  const iconHTML = `
    <style type="text/css">
      .${iconClass} {
        width: 1em;
        height: 1em;
      }

      ${selectors.join(',')} {
        pointer-events: none;
      }
    </style>
    ${symbols}
  `;

  document
    .body
      .insertAdjacentHTML("beforeend", iconHTML);
}

